<!doctype html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <meta name="description" content="The intersection of development and design." />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

  <title>Serverless Download from Object Storage</title>

  <link rel="icon" type="image/x-icon" href="/img/edit.svg">  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&display=swap" rel="stylesheet">

  <link rel="alternate" type="application/rss+xml" title="Kevin Hoyt" href="/feed.xml" />  

  <link rel="stylesheet" href="/style/kevinhoyt.css" />
  <link rel="stylesheet" href="/style/header.css" />
  <link rel="stylesheet" href="/style/contact.css" />    
  <link rel="stylesheet" href="/style/post.css" />
  <link rel="stylesheet" href="/style/prism.css" />    
  <link rel="stylesheet" href="/style/footer.css" />

</head>
<body>
  
  <header id="header">

  <article>

    <kh-follow>
      <img alt="Kevin Hoyt" src="/img/krhoyt.jpg">
    </kh-follow>

    <nav>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
        <path fill="currentColor" d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h16q.425 0 .713.288T21 17t-.288.713T20 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z"/>
      </svg>         
      <select aria-label="Section">
        <option value="/" >Home</option>
        <option value="/blog" selected>Writing</option>
        <option value="/about" >About</option>
        <option value="/events" >Events</option>
      </select>      
    </nav>

    <ul>
      <li><a aria-label="Home" href="/">Home</a></li>
      <li><a aria-label="Writing (Blog)" href="/blog">Writing</a></li>    
      <li><a aria-label="About" href="/about">About</a></li>
      <li><a aria-label="Events" href="/events">Events</a></li>
    </ul>  

    <div>

      <!-- Bluesky (not listed)
      <a aria-label="Bluesky" href="https://bsky.app/profile/krhoyt.bsky.social" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
          <path fill="currentColor" d="M12 11.388c-.906-1.761-3.372-5.044-5.665-6.662c-2.197-1.55-3.034-1.283-3.583-1.033C2.116 3.978 2 4.955 2 5.528c0 .575.315 4.709.52 5.4c.68 2.28 3.094 3.05 5.32 2.803c-3.26.483-6.157 1.67-2.36 5.898c4.178 4.325 5.726-.927 6.52-3.59c.794 2.663 1.708 7.726 6.444 3.59c3.556-3.59.977-5.415-2.283-5.898c2.225.247 4.64-.523 5.319-2.803c.205-.69.52-4.825.52-5.399c0-.575-.116-1.55-.752-1.838c-.549-.248-1.386-.517-3.583 1.033c-2.293 1.621-4.76 4.904-5.665 6.664"/>
        </svg>
      </a>
      -->

      <!-- Twitter (not listed)
      <a aria-label="Twitter" href="https://x.com/krhoyt" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
          <path fill="currentColor" fill-rule="evenodd" d="M5 1a4 4 0 0 0-4 4v14a4 4 0 0 0 4 4h14a4 4 0 0 0 4-4V5a4 4 0 0 0-4-4zm-.334 3.5a.75.75 0 0 0-.338 1.154l5.614 7.45l-5.915 6.345l-.044.051H6.03l4.83-5.179l3.712 4.928a.75.75 0 0 0 .337.251h4.422a.75.75 0 0 0 .336-1.154l-5.614-7.45L20.017 4.5h-2.05l-4.83 5.18l-3.714-4.928a.75.75 0 0 0-.337-.252zm10.88 13.548L6.431 5.952H8.45l9.114 12.095z" clip-rule="evenodd"/>
        </svg>
      </a>
      -->      

      <!-- LinkedIn -->
      <a aria-label="LinkedIn" href="https://www.linkedin.com/in/parkerkrhoyt" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
          <path fill="currentColor" d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93zM6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37z"/>
        </svg>
      </a>      

      <!-- GitHub -->
      <a aria-label="GitHub" href="https://github.com/krhoyt" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
          <path fill="currentColor" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/>
        </svg>
      </a>      

      <!-- YouTube -->
      <a aria-label="YouTube" href="https://www.youtube.com/channel/UCSFeFhtLBuzU2UMs7oOL54A" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
          <path fill="currentColor" d="m10 15l5.19-3L10 9zm11.56-7.83c.13.47.22 1.1.28 1.9c.07.8.1 1.49.1 2.09L22 12c0 2.19-.16 3.8-.44 4.83c-.25.9-.83 1.48-1.73 1.73c-.47.13-1.33.22-2.65.28c-1.3.07-2.49.1-3.59.1L12 19c-4.19 0-6.8-.16-7.83-.44c-.9-.25-1.48-.83-1.73-1.73c-.13-.47-.22-1.1-.28-1.9c-.07-.8-.1-1.49-.1-2.09L2 12c0-2.19.16-3.8.44-4.83c.25-.9.83-1.48 1.73-1.73c.47-.13 1.33-.22 2.65-.28c1.3-.07 2.49-.1 3.59-.1L12 5c4.19 0 6.8.16 7.83.44c.9.25 1.48.83 1.73 1.73"/>
        </svg>
      </a>          

      <!-- RSS feed -->
      <a aria-label="RSS Feed (XML)" href="/feed.xml" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
          <path fill="currentColor" d="M5 21q-.825 0-1.412-.587T3 19t.588-1.412T5 17t1.413.588T7 19t-.587 1.413T5 21m13.5 0q-.65 0-1.088-.475T16.9 19.4q-.275-2.425-1.312-4.537T12.9 11.1T9.138 8.413T4.6 7.1q-.65-.075-1.125-.512T3 5.5t.45-1.062t1.075-.363q3.075.275 5.763 1.563t4.737 3.337t3.338 4.738t1.562 5.762q.05.625-.363 1.075T18.5 21m-6 0q-.625 0-1.075-.437T10.85 19.5q-.225-1.225-.787-2.262T8.65 15.35t-1.888-1.412T4.5 13.15q-.625-.125-1.062-.575T3 11.5q0-.65.45-1.075t1.075-.325q1.825.25 3.413 1.063t2.837 2.062t2.063 2.838t1.062 3.412q.1.625-.325 1.075T12.5 21"/>
        </svg>
      </a>      

      <!-- Instagram (not listed)
      <a aria-label="Instagram" href="https://www.instagram.com/parkerkrhoyt" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 14 14">
          <path fill="currentColor" fill-rule="evenodd" d="M3.39.787A2.604 2.604 0 0 0 .786 3.39v6.944a2.604 2.604 0 0 0 2.604 2.604h6.944a2.604 2.604 0 0 0 2.603-2.604V3.39A2.604 2.604 0 0 0 10.334.787zm7.693 2.607a.75.75 0 1 1-1.5 0a.75.75 0 0 1 1.5 0m-4.22 1.388a2.08 2.08 0 1 0 0 4.16a2.08 2.08 0 0 0 0-4.16m-3.081 2.08a3.08 3.08 0 1 1 6.16 0a3.08 3.08 0 0 1-6.16 0" clip-rule="evenodd"/>
        </svg>
      </a>
      -->     

    </div>

  </article>

</header>


  
  
    <main>

      <div>

        <img src="/img/covers/whisk.jpg" alt="Serverless Download from Object Storage">

        

      </div>

      <article>

        <h1>Serverless Download from Object Storage</h1>

        <time>Jan 30, 2019 · 10 min read</time>

        
          <aside>
            
              <p>App Dev</p>
            
              <p>Data</p>
            
          </aside>
                
        
        <p>In the <a href="/2019/01/23/upload-files-to/">previous post</a>, I walked through how to upload a file from an HTTP multipart client, to an <a href="https://console.bluemix.net/openwhisk/">IBM Cloud Function</a>, and how to persist that file on <a href="https://www.ibm.com/cloud/object-storage">IBM Cloud Object Storage</a> (COS). In this post I will explore getting the file back out of COS and downloaded to an HTTP client.</p>
<h2>Get Outta My COS</h2>
<p>And into my <a href="https://www.youtube.com/watch?v=zNgcYGgtf8M">car</a>! Ahem ...</p>
<p>IBM Cloud Object Storage is compatible with AWS S3. Just as in the previous post we will use the IBM <a href="https://github.com/ibm/ibm-cos-sdk-js">fork</a> of that SDK for Node.js. And the first step is to instantiate the client. If you are confused on where to get the various credentials, I cover that in detail in the previous post as well.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">let</span> cos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AWS<span class="token punctuation">.</span>S3</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">endpoint</span><span class="token operator">:</span> params<span class="token punctuation">.</span><span class="token constant">COS_ENDPOINT</span><span class="token punctuation">,</span>
  <span class="token literal-property property">apiKeyId</span><span class="token operator">:</span> params<span class="token punctuation">.</span><span class="token constant">COS_API_KEY</span><span class="token punctuation">,</span>
  <span class="token literal-property property">ibmAuthEndpoint</span><span class="token operator">:</span> params<span class="token punctuation">.</span><span class="token constant">COS_AUTH_ENDPOINT</span><span class="token punctuation">,</span>
  <span class="token literal-property property">serviceInstanceId</span><span class="token operator">:</span> params<span class="token punctuation">.</span><span class="token constant">COS_SERVICE_INSTANCE</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

cos<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">Bucket</span><span class="token operator">:</span> params<span class="token punctuation">.</span><span class="token constant">COS_BUCKET</span><span class="token punctuation">,</span>
  <span class="token literal-property property">Key</span><span class="token operator">:</span> params<span class="token punctuation">.</span>name
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span> <span class="token parameter">data</span> <span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> data <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The <code>getObject()</code> call on the COS client requires the name of the <code>Bucket</code> where the object resides, and the name of the object you want to get. Note that name and <code>Key</code> are synonymous. This is effectively the path and file name of the object you want to download.</p>
<blockquote>
<p>Watch out! If the file does not exist, the SDK will throw an error effectively halting the execution of the function. You may want to do a bit more error catching than is demonstrated in the snippet above.</p>
</blockquote>
<h2>And Into My Function</h2>
<p>There are a couple subtleties that we need to consider for the Cloud Function side of this equation. The first is that the COS client is promise-based, which means we need to wait for it to finish before terminating the function itself. The second is what exactly do we return?</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">download</span><span class="token punctuation">(</span> <span class="token parameter">params</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token constant">AWS</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">'ibm-cos-sdk'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> cos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AWS<span class="token punctuation">.</span>S3</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">endpoint</span><span class="token operator">:</span> params<span class="token punctuation">.</span><span class="token constant">COS_ENDPOINT</span><span class="token punctuation">,</span>
    <span class="token literal-property property">apiKeyId</span><span class="token operator">:</span> params<span class="token punctuation">.</span><span class="token constant">COS_API_KEY</span><span class="token punctuation">,</span>
    <span class="token literal-property property">ibmAuthEndpoint</span><span class="token operator">:</span> params<span class="token punctuation">.</span><span class="token constant">COS_AUTH_ENDPOINT</span><span class="token punctuation">,</span>
    <span class="token literal-property property">serviceInstanceId</span><span class="token operator">:</span> params<span class="token punctuation">.</span><span class="token constant">COS_SERVICE_INSTANCE</span>
  <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> cos<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">Bucket</span><span class="token operator">:</span> params<span class="token punctuation">.</span><span class="token constant">COS_BUCKET</span><span class="token punctuation">,</span> 
    <span class="token literal-property property">Key</span><span class="token operator">:</span> params<span class="token punctuation">.</span>name
  <span class="token punctuation">}</span> <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span> <span class="token parameter">data</span> <span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token string-property property">'Content-Disposition'</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">attachment; filename="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> data<span class="token punctuation">.</span>ContentType 
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">statusCode</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
      <span class="token literal-property property">body</span><span class="token operator">:</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span> data<span class="token punctuation">.</span>Body <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span> <span class="token string">'base64'</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

exports<span class="token punctuation">.</span>main <span class="token operator">=</span> download<span class="token punctuation">;</span></code></pre>
<p>In the previous post we wrapped our callback-filled parsing code in a <code>Promise</code> and returned that reference. That kept the function running. In this case, the COS SDK is promise-based, and we can then return the promise generated by the call to <code>getObject()</code> itself.</p>
<p>As far as what to return, we have to stops. The first is in the headers of the return value. In order to prompt for a download, we need to set the header <code>Content-Disposition</code>. The result from the <code>getObject()</code> call, will have the appropriate content type we can use in the header as well.</p>
<p>The <code>body</code> of the return object should be the contents of the file, Base-64 encoded. The bytes that make up the file are in the <code>data</code> object result from the <code>getObject()</code> call in a property labeled <code>Body</code>. We can put that into a <code>Buffer</code> instance, and leverage <code>toString( 'base64' )</code> to get the Base-64 encoded content.</p>
<h2>Moar Integration!</h2>
<p>At this point we can read, edit, and add for our BREAD operations. We are so close, and the code is so similar, that rather than make another blog post, I will round out the operations in the following code snippets. First up, browse.</p>
<p><strong>Browse the Objects in a Bucket</strong></p>
<p>The AWS S3 documentation has <code>listObjects()</code> and <code>listObjectsV2()</code> and suggest that it prefers the later. The <code>listObjectsV2()</code> takes the argument <code>Bucket</code> name, and will only return 1,000 items. If you have more than 1,000 items in your bucket, you will need to page through them.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">return</span> cos<span class="token punctuation">.</span><span class="token function">listObjectsV2</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">Bucket</span><span class="token operator">:</span> params<span class="token punctuation">.</span><span class="token constant">COS_BUCKET</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span> <span class="token parameter">data</span> <span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> body <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> c <span class="token operator">&lt;</span> data<span class="token punctuation">.</span>Contents<span class="token punctuation">.</span>length<span class="token punctuation">;</span> c<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    body<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> data<span class="token punctuation">.</span>Contents<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>Key<span class="token punctuation">,</span>
      <span class="token literal-property property">etag</span><span class="token operator">:</span> data<span class="token punctuation">.</span>Contents<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>ETag<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">"</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">""</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">modified</span><span class="token operator">:</span> data<span class="token punctuation">.</span>Contents<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>LastModified<span class="token punctuation">,</span>
      <span class="token literal-property property">size</span><span class="token operator">:</span> data<span class="token punctuation">.</span>Contents<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">.</span>Size
    <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span>          
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> body
  <span class="token punctuation">}</span><span class="token punctuation">;</span>      
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The <code>data</code> object in this case is an array, where each object in the array has a <code>Key</code> property (file name), <code>LastModified</code>, <code>Size</code>, and <code>ETag</code>. You can effectively return the data as-is. I am being picky here in forcing lowercase keys. The <code>ETag</code> value is also enclosed in nested quotes, so I clean that up to get get the raw string as the value.</p>
<p><strong>Delete an Object in a Bucket</strong></p>
<p>Finally we come to removing an object from a bucket. This is pretty much the same as getting an object list from a bucket. And just like the listing, you can return the call to <code>deleteObject()</code> and the resulting promise to keep the function running. The return from a single deletion is ... nothing. I return the file name that was just deleted as a courtesy.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">return</span> cos<span class="token punctuation">.</span><span class="token function">deleteObject</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">Bucket</span><span class="token operator">:</span> params<span class="token punctuation">.</span><span class="token constant">COS_BUCKET</span><span class="token punctuation">,</span>
  <span class="token literal-property property">Key</span><span class="token operator">:</span> params<span class="token punctuation">.</span>name
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span> <span class="token parameter">data</span> <span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">statusCode</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> params<span class="token punctuation">.</span>name
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The parameters passed to <code>deleteObject()</code> include the <code>Bucket</code> (file path) and <code>Key</code> (file name).</p>
<h2>Next Steps</h2>
<p>We can now leverage all the BREAD operations (browse, read, edit, add, delete) from within an IBM Cloud Function, persisting files to IBM Cloud Object Storage. From here we could build our own serverless-based file manager. I am kicking around the idea of a VSCode plug-in to manage those files in my COS buckets.</p>

        
      </article>

    </main>

          

  <section id="contact">

  <h2>Let's Build Something Together</h2>

  <p>
    Have a project, collaboration, or opportunity you would like to discuss?
    I am especially interested in work involving web architecture, data,
    IoT, and developer experience.
  </p>

  <form data-netlify="true" netlify-honeypot="bot-field">

    <!-- Honeypot -->
    <div class="field honeypot">
      <label for="pot">Do not fill this out if you are human</label>
      <input id="pot" name="pot" type="text">      
    </div>

    <div class="field">
      <label for="poc">Name</label>
      <input type="text" id="poc" name="name" required>
    </div>

    <div class="field">
      <label for="email">Email</label>
      <input type="email" id="email" name="email" required>
    </div>

    <div class="field">
      <label for="reason">Subject</label>
      <select id="reason" name="reason">
        <option value="">Select an option</option>
        <option value="Feedback">Writing feedback</option>        
        <option value="Project Collaboration">Project collaboration</option>
        <option value="Consulting">Consulting</option>
        <option value="Speaking">Speaking / workshops</option>
        <option value="Career Opportunity">Career opportunity</option>
        <option value="Other">Something else</option>
      </select>
    </div>

    <div class="field">
      <label for="message">Message</label>
      <textarea id="message" name="message" rows="6" required></textarea>
    </div>

    <button aria-label="Send Message" type="button">Send Message</button>    

  </form>

  <p class="email">
    Prefer email? You can reach me at <a aria-label="Email kevin@ketnerlake.com" href="mailto:kevin@ketnerlake.com">kevin@ketnerlake.com</a>.
  </p>

</section>

  <footer id="footer">

  <p>
    Made with ❤️ by Kevin Hoyt &copy; 2025 · Published with <a aria-label="Eleventy" href="https://www.11ty.dev">Eleventy</a>
  </p>
  
</footer>


  <script src="/script/menu.js"></script>

</body>
</html>
